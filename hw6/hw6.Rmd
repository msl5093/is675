---
title: "HW6"
author: "Mike Lehman"
date: "October 26, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

The goal of this assessment is to complete a market basket analysis through the use of association rule learning. Association rules identify patterns found in relationships among items found in sets, known as itemsets. Itemsets are simply sets of items that occur together. In summation, association rule learning is an unsupervised machine learning process that attempts to find patterns in the relationships among groups of items that occur together in a given data set.

Conveniently enough, to explore association rule learning through market basket analysis, we will use a data set comprised of grocery store transactions.

## Data Collection and Preparation

The data set used for this assessment is a simple .csv file that contains 9835 rows of sets of items. The sets of items consist of various combinations of grocery items (169 total) in generic categories such as: milk, yogurt, rolls. This is important to note as we will not have the level of data to perform highly granular rule mining for specific brands, flavors, or types of items. Instead we will be looking for patterns to be found in these generic categories of grocery items.

This type of transactional data is of a structure that would not translate well into a typical R data frame. When reading this data into a data frame, R will attempt to create the data frame dimensions based on the first row in the .csv file. This means that the data frame will have four columns even though our data set has many transactions with more of fewer items. Additionally, as the column values will be considered to have a relationship relative to the order in which they appear. That is, the same value (e.g. "coffee") appearing in column one, will be treated differently than an instance of "coffee" that appears in column ten.

The solution to this problem is to load the data set into a sparse matrix. A sparse matrix is simply a two-dimensional data structure where each row represents a transaction, with the columns being a feature (item) and the cell value indicating whether or not the item appears. Because the structure is a sparse matrix, this indicates that most of the cells will be empty; however, this allows for any of the 169 possible features to appear in a given transaction.

To read the transactional data into R, we will use the read.transactions() function. We will also load the arules library which will be used to create our model:

```{r}
library(arules)
groceries <- read.transactions("groceries.csv", sep = ",")
summary(groceries)
```

From the summary output of the data, we can see our dimensions: 9835 rows (transactions) and 169 columns (items). The density of the sparse matrix (0.026) indicates that only 2.6% of the cells have actual values. Additionally, the output provides a list of the most frequent items and a useful table that tells us how many transactions have N number of items. For example, 2159 transactions have only one item, 1643 have two, and so on. Finally, there are the summary statistics for the number of items across all transactions.

The first five transactions show us how each individual transactions appears:

```{r}
inspect(groceries[1:5])
```

Each transaction is an itemset of N number of items. 

```{r}
itemFrequency(groceries[, 1:3])
```

The output from itemFrequency shows the support level, in this case, for the first three items (columns) in the data. The support level of an itemset refers to how frequently it appears in the data. That is, support(x) = count(x) / N where N is the number of transactions in the data.

In addition to the support level, association rules can also be evaluated using the confidence level. The confidence level is a measurement of the predictive power of a rule. Here we imply a rule to mean the content and order of items in an itemset. This tells us the proportion of transactions where the presence of item X indicates the presence of item Y. It is important to note that the order is relevant here, confidence of X -> Y is not the same as a confidence of Y -> X.

To further explore our data, the arules library includes functions to plot the frequency of items based on certain criteria. 

```{r}
itemFrequencyPlot(groceries, support = 0.1)
```

Here we have plotted the frequency of items with a minimum support level of 0.1. This means, plot the frequency of items where the item appears in at least ten percent of the transactions.

Next, we will plot the items that appear at least 20 times in the data:

```{r}
itemFrequencyPlot(groceries, topN = 20)
```

These plots can be useful for exploring what items appear frequently, and can help to explore and improve results when assessing specific rules. 

Finally, since our data is a sparse matrix, we can illustrate the distribution of the cells using image():

```{r}
image(groceries[1:5])
```

The plot shows the disbution of the items in the first five transactions in the data. We can illustrate other parts of the matrix as well:

```{r}
image(sample(groceries, 100))
```

Here, we have taken a random sample of 100 transactions to see the distribution of items. 

## Train Model



## Evaluating Model Performance


## Improving Model Performance


## Conclusion


[R Source](hw6.R) 